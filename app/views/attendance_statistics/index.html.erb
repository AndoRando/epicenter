<h1 class="page-header">Attendance statistics</h1>

<ul class="nav nav-tabs">
  <li class="active class-attendance-header">
    <a>Class Statistics</a>
  </li>
  <li class="day-attendance-header">
    <a>Attendance for <%= Date.today.to_formatted_s(:long) %></a>
  </li>
</ul>

<div class="class-stats">
  <%= line_chart @attendance_statistic.daily_presence,
        library: {
          hAxis: { format: "MMM d" },
          title: 'Number of students present',
          chartArea: { left: 20, top: 20, right: 20, width: '95%', height: '75%' },
          colors: ['#2980b9']
        } %>

  <h3>Students</h3>
  <%= bar_chart @attendance_statistic.student_attendance_data, stacked: true,
        library: {
          height: @cohort.students.length * 50,
          hAxis: {
            baseline: 'transparent',
            textStyle: { color: 'transparent' }
          },
          chartArea: { left: 150, top: 20, right: 0, width: '100%', height: "90%" },
          bar: { groupWidth: '60%' },
          legend: { position: 'none' },
          colors: ['#06BA63', '#F9DF74', '#F9DF74', '#D1495B']
        } %>
</div>

<div class="day-stats">
  <% @cohort.attendance_for_today.each do |attendance_record| %>
    <ul class="span8 unstyled">
        <li>
            <span class="span3"><%= link_to attendance_record.student.name, attendance_record.student, class: 'unstyled-link' %></span>
            <span>
              <% if attendance_record.tardy %>
                <span class="btn btn-warning span3" disabled>Tardy</span>
              <% elsif attendance_record.left_early %>
                <span class="btn btn-warning span3" disabled>Left early</span>
              <% else %>
                <span class="btn btn-success span3" disabled>On time</span>
              <% end %>
            </span>
            <span class="pull-right">
              <%= link_to 'Edit', new_attendance_record_amendment_path(student: attendance_record.student, day: attendance_record.date), class: 'unstyled-link'  %>
            </span>
        </li>
    </ul>
  <% end %>
</div>
